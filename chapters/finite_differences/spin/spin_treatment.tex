\subsection{Spin}
In the case of this work, dealing with non relativisitic quantum mechanics, we treat spin as an additional degree of freedom of our single particle system.
\\Recalling the commutators that define the spin operator in 3 dimensions:
\begin{equation}
    [S_i, S_j] = i\hbar \epsilon_{ijk} S_k
\end{equation}
Where $\epsilon_{ijk}$ is the Levi-Civita symbol.
\\Spin comes into action by means of Spin Orbit interaction through the operator $\hat {\mathbf L }\cdot \hat{\mathbf S}$.
\\$\hat{\mathbf{L}}$ acts on the Hilbert space of position by $\hat{\mathbf L} = (\mathbf r \times \mathbf p )= -i\hbar (\mathbf r \times \nabla)$.
\\While $\hat{\mathbf S}$ acts on the Hilbert space of spin, a representation of $\text{SU}(2)$ where the basis vectors are its projection on the $z$ axis.
\\We can then rewrite by the pauli matrices $\hat{\mathbf S} = i\frac \hbar 2 \boldsymbol {\sigma}$, where 
\begin{equation}
    \boldsymbol{\sigma} = (\sigma_x, \sigma_y, \sigma_z) = \bigg( \begin{pmatrix} 0 & 1 \\ 1 & 0 \end{pmatrix}, \begin{pmatrix} 0 & -i \\ i & 0 \end{pmatrix},\ \begin{pmatrix} 1 & 0 \\ 0 & -1 \end{pmatrix} \bigg)
\end{equation}
\subsubsection{Spin and finite differences}
Working in 3D, together with spin, the lattice on which we want to solve our eigenvalue problem is given by sets of points $\mathcal{X}, \mathcal{Y}, \mathcal{Z}$ as done previously, while the spin, discrete by nature, can be represented by 
\begin{equation}
    \mathcal{S} = \{ -\hbar /2, \hbar / 2\}
\end{equation}
Since we're adding a "fourth" dimension to the problem, the transformations that maps all the different indeces to a single one will be
\begin{equation}
    F(i, j, k, s) = s + 2 (i+N_x(j+N_y k))
\end{equation}
Where 2 comes from the size of the spin representation.
\subsection{Parametrization and discretization of the spin orbit interaction}
In the case of the Woods Saxon potential, the spin orbit is phenomenologically parametrized as
\begin{equation}
    \hat {H}_\text{SO} = v_{\text{LS}}(\mathbf{r})\mathbf{L}\cdot \mathbf{S}
\end{equation}
Where 
\begin{equation}
    v_{\text{LS}}(\mathbf{r}) = v_{\text{LS}}^{(0)}\bigg(\frac{r_0}{\hbar}\bigg)^2\frac 1 r \bigg[\dv{r}\frac 1 {1+ e^{\frac{r-R}{a}}}\bigg]
\end{equation}
We can develop the product 
\begin{equation}
    \mathbf{L}\cdot \mathbf{S} = -i\frac {\hbar^2} 2 \bigg(\sigma_x \bigg(y\pdv{z} - z\pdv{y}\bigg) + \sigma_y \bigg(z\pdv{x} - x\pdv{z}\bigg) + \sigma_z \bigg(x\pdv{y} - y\pdv{x}\bigg)\bigg)
\end{equation}
Using finite differences, thanks to the approximation in equation \ref{eq:finite_diff_first_dv}, we are able to write the first partial derivatives in terms of $\psi$
\begin{align*}
    \pdv{\psi}{x} = \frac {\psi_{i+1, j, k} - \psi_{i-1, j, k}}{2h_x}
    ;&\ \pdv{\psi}{y} = \frac {\psi_{i, j+1, k} - \psi_{i, j-1, k}}{2h_y}
    ;&\ \pdv{\psi}{z} = \frac {\psi_{i, j, k+1} - \psi_{i, j, k-1}}{2h_z}
\end{align*}
It's obious that the matrix elements describing the spin orbit interaction will be off-diagonal, since they are non local.
\\The discretized $\hat H$, a matrix $2N_x N_y N_z\times 2N_x N_y N_z$ will then be the sum $T + V + H_{\text{SO}}$ of the kinetic energy, the potential energy and the spin orbit interaction. 

